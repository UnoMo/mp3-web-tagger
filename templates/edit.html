{% extends "base.html" %}
{% block content %}

<div class="card">
  <div>
    <div>
      <h2>Edit tags — {{ filename }}</h2>
      {% if common.title or common.artist %}
        <div class="muted">
          {% if common.title %}<strong>{{ common.title }}</strong>{% endif %}
          {% if common.artist %} — {{ common.artist }}{% endif %}
        </div>
      {% endif %}
    </div>

    <div class="actions">
      <a class="btn" href="{{ url_for('explore') }}">← Explore</a>

      {% if prev_name %}
        <a class="btn" href="{{ url_for('edit', filename=prev_name) }}">&laquo; Prev</a>
      {% else %}
        <span class="btn">&laquo; Prev</span>
      {% endif %}

      {% if next_name %}
        <a class="btn" href="{{ url_for('edit', filename=next_name) }}">Next &raquo;</a>
      {% else %}
        <span class="btn">Next &raquo;</span>
      {% endif %}
    </div>
  </div>

  <form action="{{ url_for('update', filename=filename) }}" method="post">
</div>

<div class="row">
  <div class="card">
    <h3>Front cover</h3>
    {% if cover_front %}
      <img class="cover" src="{{ cover_front.data_url }}" alt="Front cover">
    {% else %}
      <p class="muted">No front cover embedded.</p>
    {% endif %}
    <form action="{{ url_for('add_cover', filename=filename) }}" method="post" enctype="multipart/form-data">
      <input type="hidden" name="kind" value="front">
      <label>Replace / Add (JPG/PNG/GIF/WEBP/BMP)</label>
      <input type="file" name="image" accept=".jpg,.jpeg,.png,.gif,.webp,.bmp">
      <div class="actions">
        <button class="btn" type="submit">Update front cover</button>
      </div>
    </form>
    <form class="inline" action="{{ url_for('remove_cover_route', filename=filename) }}" method="post">
      <input type="hidden" name="kind" value="front">
      <button class="btn" type="submit">Remove front</button>
    </form>
  </div>

  <div class="card">
  <h2>Edit tags — {{ filename }}</h2>
  <form action="{{ url_for('update', filename=filename) }}" method="post">
    <div class="row">
      <div>
        <label>Title</label><input type="text" name="title" value="{{ common.title or '' }}">
        <label>Artist</label><input type="text" name="artist" value="{{ common.artist or '' }}">
        <label>Album</label><input type="text" name="album" value="{{ common.album or '' }}">
        <label>Album Artist</label><input type="text" name="albumartist" value="{{ common.albumartist or '' }}">
        <label>Composer</label><input type="text" name="composer" value="{{ common.composer or '' }}">
      </div>
      <div>
        <label>Genre</label><input type="text" name="genre" value="{{ common.genre or '' }}">
        <label>Date (YYYY or free text)</label><input type="text" name="date" value="{{ common.date or '' }}">
        <label>Track (N or N/M)</label><input type="text" name="track" value="{{ common.track or '' }}">
        <label>Disc (N or N/M)</label><input type="text" name="disc" value="{{ common.disc or '' }}">
      </div>
    </div>
    <label>Comment</label>
    <textarea name="comment" rows="2">{{ common.comment or '' }}</textarea>
    <label>Lyrics</label>
    <textarea name="lyrics" rows="5">{{ common.lyrics or '' }}</textarea>

    <div class="actions">
      <button class="btn primary" type="submit">Save tags</button>
      <a class="btn" href="{{ url_for('download_cover', filename=filename) }}">Download cover</a>
    </div>
  </form>
</div>

  <div class="card">
    <h3>Back cover</h3>
    {% if cover_back %}
      <img class="cover" src="{{ cover_back.data_url }}" alt="Back cover">
    {% else %}
      <p class="muted">No back cover embedded.</p>
    {% endif %}
    <form action="{{ url_for('add_cover', filename=filename) }}" method="post" enctype="multipart/form-data">
      <input type="hidden" name="kind" value="back">
      <label>Replace / Add (JPG/PNG/GIF/WEBP/BMP)</label>
      <input type="file" name="image" accept=".jpg,.jpeg,.png,.gif,.webp,.bmp">
      <div class="actions" style="margin-top:.6rem">
        <button class="btn" type="submit">Update back cover</button>
      </div>
    </form>
    <form class="inline" action="{{ url_for('remove_cover_route', filename=filename) }}" method="post">
      <input type="hidden" name="kind" value="back">
      <button class="btn" type="submit">Remove back</button>
    </form>
  </div>
</div>

<div class="card">
  <h3>Remove all covers</h3>
  <form class="inline" action="{{ url_for('remove_cover_route', filename=filename) }}" method="post">
    <input type="hidden" name="kind" value="all">
    <button class="btn" type="submit">Remove all</button>
  </form>
</div>

{% endblock %}